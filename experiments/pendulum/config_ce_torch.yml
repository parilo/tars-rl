framework: torch
device: cpu

env:
  name: Pendulum-v0
  is_gym: True

  obs_shapes: [[3]]
  obs_dtypes: ["float32"]
  obs_is_image: False
  history_length: [2]

  action_size: 1
  frame_skip: 2
  step_limit: 0
  agent_buffer_size: 110
  reward_scale: 0.1
  reinit_random_action_every: 5
  log_every_n_steps: 1000
  max_episode_length: 110

server:
  seed: 42
  num_clients: 16
  experience_replay_buffer_size: 5000000
  use_prioritized_buffer: false
  train_every_nth: 1
  start_learning_after: 16
  target_critic_update_period: 1
  target_actor_update_period: 1
  show_stats_period: 100
  save_model_period: 5000
  client_start_port: 10977
  logdir: "logs/pendulum_asd"
  #load_checkpoint: ""

algo_name: "cross_entropy_method"

algorithm:
  n_step: 1
  gamma: 0.99
  actor_grad_val_clip: 1.0
  target_actor_update_rate: 0.0025
  target_critic_update_rate: 0.005

actor:
  nn_arch:

    - input: 0
      name: "output"
      layers:
        - type: "Flatten"

        - type: "Linear"
          args:
            in_features: 6
            out_features: 128

        - type: "ReLU"

        - type: "Linear"
          args:
            in_features: 128
            out_features: 128

        - type: "ReLU"

        - type: "Linear"
          args:
            in_features: 128
            out_features: 128

        - type: "ReLU"

        - type: "Linear"
          args:
            in_features: 128
            out_features: 2  # 2 x number of actions, mean + std

#            activation: "linear"
#            kernel_initializer:
#              class: "RandomUniform"
#              module: "tensorflow.python.keras.initializers"
#              args:
#                minval: -0.003
#                maxval: 0.003
#            bias_initializer:
#              class: "RandomUniform"
#              module: "tensorflow.python.keras.initializers"
#              args:
#                minval: -0.003
#                maxval: 0.003

actor_optim:
  module: torch.optim
  class: Adam
  schedule:
    - limit: 0  # of train ops
      lr: 0.001

training:
  schedule:
    - limit: 0  # of train ops
      batch_size: 16  # batch of episodes

agents:
  - algorithm_id: 0
    agents:
      - agents_count: 1
        visualize: True

#      - agents_count: 1
#        visualize: False
#
#      - agents_count: 1
#        visualize: True
#        exploration:
#          normal_noise: 0.5
#          random_action_prob: 0.2
#
#      - agents_count: 4
#        visualize: False
#        exploration:
#          normal_noise: 0.5
#          random_action_prob: 0.2
